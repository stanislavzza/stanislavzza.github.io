<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="David Eubanks">

<title>Appendix A: Statistical Details – The Kappa Zoo</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-e26003cea8cd680ca0c55a263523d882.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-f3c2ea88cadbcfb37ba28ffa2c97cfc1.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-XP6WMESY52"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-XP6WMESY52', { 'anonymize_ip': true});
</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">The Kappa Zoo</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contents</h2>
   
  <ul class="collapse">
  <li><a href="#closed-form-accuracy-coefficients" id="toc-closed-form-accuracy-coefficients" class="nav-link active" data-scroll-target="#closed-form-accuracy-coefficients"><span class="header-section-number">1</span> Closed Form Accuracy Coefficients</a></li>
  <li><a href="#correlation-of-ratings-between-raters" id="toc-correlation-of-ratings-between-raters" class="nav-link" data-scroll-target="#correlation-of-ratings-between-raters"><span class="header-section-number">2</span> Correlation of Ratings between Raters</a></li>
  <li><a href="#correlation-between-ratings-and-true-values" id="toc-correlation-between-ratings-and-true-values" class="nav-link" data-scroll-target="#correlation-between-ratings-and-true-values"><span class="header-section-number">3</span> Correlation Between Ratings and True Values</a></li>
  <li><a href="#alternate-derivation-of-fleiss-kappa-relationship" id="toc-alternate-derivation-of-fleiss-kappa-relationship" class="nav-link" data-scroll-target="#alternate-derivation-of-fleiss-kappa-relationship"><span class="header-section-number">4</span> Alternate Derivation of Fleiss Kappa Relationship</a></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Appendix A: Statistical Details</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>David Eubanks </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="closed-form-accuracy-coefficients" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Closed Form Accuracy Coefficients</h1>
<p>We’ll show that</p>
<p><span class="math display">\[
a^2 = \sum_{k=0}^R\beta_k\eta_k
\]</span> for unbiased raters (<span class="math inline">\(t=p\)</span>), so that the Fleiss kappa can be expressed as a weighted sum of the proportions of subject counts of Class 1 ratings. This provides details for the section on exact formulas in Chapter 2. A closed form for the coefficients is derived below.</p>
<p>The Fleiss kappa calculates match rates per subject. Suppose we have <span class="math inline">\(R\)</span> raters who assigned <span class="math inline">\(k\)</span> ratings of Class 1 for subject <span class="math inline">\(i\)</span>, then the number of matched ratings is the sum of Class 1 matches and Class 0 matches, or <span class="math inline">\(M_i = k(k-1)/2 + \bar{k}(\bar{k}-1)/2\)</span>, where <span class="math inline">\(\bar{k} = R - k\)</span>. The match rate is this count out of the number of possible matches, which is <span class="math inline">\(R(R-1)/2\)</span>. With <span class="math inline">\(R\)</span> raters, <span class="math inline">\(k \epsilon \{0,1,..,R\}\)</span>, and over the <span class="math inline">\(N\)</span> subjects there will be some count <span class="math inline">\(n_k\)</span> for the number of the occurances of each possible value of <span class="math inline">\(k\)</span>. The Fliess kappa calculation averages over these subject match rates. This average match rate <span class="math inline">\(m_o\)</span> can be simplified with</p>
<p><span class="math display">\[
\begin{aligned}
m_o &amp;=  \frac{2}{NR(R-1)}\sum_{k=0}^{R} n_k M_k \\
&amp;= \frac{1}{R(R-1)}\sum_{k=0}^{R} \eta_k \left( k(k-1) + \bar{k}(\bar{k}-1) \right)\\
&amp;= \frac{1}{R(R-1)}\sum_{k=0}^{R} \eta_k \left( 2k^2 -2Rk+R^2-R\right)\\
&amp;= \frac{1}{R-1}\sum_{k=0}^{R} \eta_k \left( R-2k-1\right) + \frac{2}{R(R-1)}\sum_{k=0}^{R} k^2\eta_k \\
&amp;= \frac{R - 1 -2 \sum_{k=0}^{R} k\eta_k  }{R-1} +  \frac{2}{R(R-1)}\sum_{k=0}^{R} k^2\eta_k \\
&amp;= 1 - \frac{2}{R-1}\sum_{k=0}^{R} k\eta_k + \frac{2}{R(R-1)}\sum_{k=0}^{R} k^2\eta_k \\
\end{aligned}
\]</span></p>
<p>where <span class="math inline">\(\eta_k = n_k / N\)</span> is the proportion of subjects with <span class="math inline">\(k\)</span> ratings of Class 1, so that <span class="math inline">\(\sum \eta_k = 1\)</span>. It will be useful to use the fact that the average rate of Class 1 ratings is</p>
<p><span class="math display">\[
c = \frac{1}{R}\sum_{k=0}^{R} k\eta_k\,,
\]</span> since the sum adds up the number of Class 1 ratings over all subjects divided by the number of subjects, and <span class="math inline">\(NR\)</span> is the total number of ratings. Using that idea, we can express</p>
<p><span class="math display">\[
\begin{aligned}
m_o &amp;= 1 - \frac{2R}{R-1}c + \frac{2}{R(R-1)}\sum_{k=0}^{R} k^2\eta_k/R \\
&amp;:= 1 - 2\frac{Rc-\gamma}{R-1} \, ,
\end{aligned}
\]</span> where <span class="math inline">\(\gamma = \sum k^2\eta_k/R\)</span> to simplify the notation.</p>
<p>The Fleiss kappa is then the difference between the average match rate and the expected match rate under independence, which is the sum of the products of the marginal proportions of Class 1 ratings for each rater.</p>
<p>The Fleiss formula is</p>
<p><span class="math display">\[
\kappa = \frac{m_o - m_c}{1 - m_c},
\]</span></p>
<p>where <span class="math inline">\(m_c = c^2 + \bar{c}^2 = 2c^2 - 2c + 1\)</span>. Here <span class="math inline">\(c\)</span> is the average Class 1 rate over all ratings,</p>
<p>So that we can express the kappa formula as <span class="math display">\[
\begin{aligned}
\kappa &amp;= \frac{1 - 2\frac{Rc-\gamma}{R-1}-2c^2 + 2c - 1  }{1-2c^2 + 2c - 1} \\
&amp;= \frac{\gamma/c-R}{(R-1)(1-c)} + 1
\end{aligned}
\]</span> Under the unbiased rater assumption we have <span class="math inline">\(p=t=c\)</span>, and if we fix <span class="math inline">\(t\)</span> to a constant, with the only unknown being <span class="math inline">\(a\)</span>, the formula reduces to</p>
<p><span class="math display">\[
\begin{aligned}
\kappa_t = a^2 &amp;=\frac{\frac{1}{Rt} \sum_{k=0}^{R} k^2\eta_k-R}{(R-1)\bar{t}} + 1 \\
         &amp;= \sum_{k=0}^{R} \left( \frac{k^2}{R(R-1)t\bar{t}}   \right)\eta_k + 1 - \frac{R}{(R-1)\bar{t}} \\
         &amp;:= \sum_{k=0}^{R} \beta_k\eta_k  \,, \\
\end{aligned}
\]</span></p>
<p>where</p>
<p><span class="math display">\[
\begin{aligned}
\beta_k &amp;= \frac{k^2}{R(R-1)t\bar{t}}+ 1 - \frac{R}{(R-1)\bar{t}}. \\
\end{aligned}
\]</span> It seems odd algebraically to bring the constants inside the sum as if they were multiplied by the <span class="math inline">\(\eta_k\)</span> proportions, but this works because <span class="math inline">\(\sum \eta_k = 1\)</span>.</p>
<p>The coefficients aren’t unique if the distribution of <span class="math inline">\(\eta_k\)</span> is symmetrical, as is the case we worked out by hand in <a href="./tapmodel.html">Chapter 2</a>, with <span class="math inline">\(R=2\)</span> and <span class="math inline">\(t = p= .5\)</span>. In case of symmetrical proportions of Class 1 ratings, we could use</p>
<p><span class="math display">\[
\begin{aligned}
\dot\beta_k &amp;= \frac{1}{2}(\beta_k+\beta_{R-k}). \\
\end{aligned}
\]</span> In the special case when <span class="math inline">\(t = p = 1/2\)</span> and <span class="math inline">\(R = 2\)</span>, we have <span class="math inline">\(\beta_0 = -3\)</span>, <span class="math inline">\(\beta_1 = -1, \beta_2 = 5\)</span>, so <span class="math inline">\(\dot \beta_0 = \beta_2 = 1\)</span> and <span class="math inline">\(\dot \beta_1 = -1\)</span> as we found with the direct derivation. In general we can’t use this method, because <span class="math inline">\(\eta_k\)</span> isn’t usually symmetrical.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>betas <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">k =</span> <span class="dv">0</span><span class="sc">:</span>R,</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">beta1 =</span> tapModel<span class="sc">::</span><span class="fu">exact_accuracy_coefs</span>(R, .<span class="dv">1</span>),</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">beta2 =</span> tapModel<span class="sc">::</span><span class="fu">exact_accuracy_coefs</span>(R, .<span class="dv">3</span>),</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">beta3  =</span>tapModel<span class="sc">::</span><span class="fu">exact_accuracy_coefs</span>(R, .<span class="dv">5</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">gather</span>(beta, val, <span class="sc">-</span>k) <span class="sc">|&gt;</span> </span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tp =</span> <span class="fu">case_when</span>( beta <span class="sc">==</span> <span class="st">"beta1"</span> <span class="sc">~</span> <span class="st">".1"</span>,</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>                           beta <span class="sc">==</span> <span class="st">"beta2"</span> <span class="sc">~</span> <span class="st">".3"</span>,</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>                           <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">".5"</span>))</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>betas <span class="sc">|&gt;</span> </span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> val, <span class="at">group =</span> tp, <span class="at">color =</span> tp)) <span class="sc">+</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"beta_k"</span>) <span class="sc">+</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Number of Class 1 ratings, k"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-betas" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-betas-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="correlation_files/figure-html/fig-betas-1.png" class="img-fluid figure-img" width="384">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-betas-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: A sample of weights for exact formulation of accuracy squared, with 30 raters and a selection of values for t=p.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>param_grid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">t =</span> <span class="fu">seq</span>(.<span class="dv">05</span>, .<span class="dv">95</span>, .<span class="dv">05</span>),</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">a =</span> <span class="fu">seq</span>(.<span class="dv">05</span>, .<span class="dv">95</span>, .<span class="dv">05</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="at">a =</span> a <span class="sc">+</span> t<span class="sc">/</span><span class="dv">30</span>,</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">a_calc =</span> <span class="cn">NA</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(param_grid)){</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  t <span class="ot">&lt;-</span> param_grid<span class="sc">$</span>t[i]</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  a <span class="ot">&lt;-</span> param_grid<span class="sc">$</span>a[i]</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  props <span class="ot">&lt;-</span> tapModel<span class="sc">:::</span><span class="fu">exact_count_probabilites</span>(<span class="dv">10</span>,t,a,t)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  tap_coefs <span class="ot">&lt;-</span> <span class="fu">exact_accuracy_coefs</span>(<span class="dv">10</span>,t)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  param_grid<span class="sc">$</span>a_calc[i] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>(props<span class="sc">*</span>tap_coefs))</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>param_grid <span class="sc">|&gt;</span> </span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> a, <span class="at">y =</span> a_calc, <span class="at">color =</span> t)) <span class="sc">+</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>() <span class="sc">+</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-validity" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-validity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="correlation_files/figure-html/fig-validity-1.png" class="img-fluid figure-img" width="384">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-validity-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Validity check, calculating accuracy from the linear representation for a range of values of t = p.
</figcaption>
</figure>
</div>
</div>
</div>
<p>The linear expression works precisely across the range of parameters in the grid illustrated in <a href="#fig-validity" class="quarto-xref">Figure&nbsp;2</a>. However, the calculation is quite sensitive to violations of the unbiased rater assumption.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>param_grid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">t =</span> <span class="fu">seq</span>(.<span class="dv">05</span>, .<span class="dv">95</span>, .<span class="dv">05</span>),</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">a =</span> <span class="fu">seq</span>(.<span class="dv">05</span>, .<span class="dv">95</span>, .<span class="dv">05</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="at">a =</span> a <span class="sc">+</span> t<span class="sc">/</span><span class="dv">30</span>,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">a_calc =</span> <span class="cn">NA</span>,</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">a_kappa =</span> <span class="cn">NA</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(param_grid)){</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  t <span class="ot">&lt;-</span> param_grid<span class="sc">$</span>t[i]</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  a <span class="ot">&lt;-</span> param_grid<span class="sc">$</span>a[i]</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  props <span class="ot">&lt;-</span> tapModel<span class="sc">:::</span><span class="fu">exact_count_probabilites</span>(<span class="dv">10</span>,t<span class="fl">-.02</span>,a,t<span class="fl">+.02</span>)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  tap_coefs <span class="ot">&lt;-</span> <span class="fu">exact_accuracy_coefs</span>(<span class="dv">10</span>,t)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  param_grid<span class="sc">$</span>a_calc[i] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>(props<span class="sc">*</span>tap_coefs))</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  counts <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">N_r =</span> <span class="dv">10</span>, <span class="at">N_c =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">n =</span> props)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  param_grid<span class="sc">$</span>a_kappa[i] <span class="ot">&lt;-</span> <span class="fu">fleiss_kappa</span>(counts)<span class="sc">$</span>a</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>param_grid <span class="sc">|&gt;</span> </span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> a, <span class="at">y =</span> a_calc, <span class="at">color =</span> t)) <span class="sc">+</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>() <span class="sc">+</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-violation" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-violation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="correlation_files/figure-html/fig-violation-1.png" class="img-fluid figure-img" width="384">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-violation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Calculations of accuracy using the linear combination with a minor violation of the unbiased rater assumption.
</figcaption>
</figure>
</div>
</div>
</div>
<p>The results in <a href="#fig-violation" class="quarto-xref">Figure&nbsp;3</a> come from calculating the coefficients with a value of <span class="math inline">\(t\)</span>, then replacing <span class="math inline">\(t\)</span> and <span class="math inline">\(p\)</span> in the simulated data with <span class="math inline">\(\hat{t} = t - .02\)</span> and <span class="math inline">\(\hat{p} = t + .02\)</span>. The resulting estimates of accuracy can become quite poor. This is not true of the Fleiss kappa, which has more robust approximation when the unbiased rater assumption is violated.</p>
<div class="cell">
<details class="code-fold">
<summary>Show the code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>param_grid <span class="sc">|&gt;</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> a, <span class="at">y =</span> a_kappa, <span class="at">color =</span> t)) <span class="sc">+</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_abline</span>() <span class="sc">+</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-fleiss" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-fleiss-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="correlation_files/figure-html/fig-fleiss-1.png" class="img-fluid figure-img" width="384">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-fleiss-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Accuracy approximations by Fleiss kappa when the unbiased rater assumption is slightly violated.
</figcaption>
</figure>
</div>
</div>
</div>
<p>The relatively low approximation error in <a href="#fig-fleiss" class="quarto-xref">Figure&nbsp;4</a> shows a direct comparison to the linear combination approximation.</p>
</section>
<section id="correlation-of-ratings-between-raters" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Correlation of Ratings between Raters</h1>
<p>Given two distinct raters <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> with common accuracy <span class="math inline">\(a\)</span> and guess probability <span class="math inline">\(p\)</span>, what’s the correlation between their ratings? Let <span class="math inline">\(c = E[C_i] = E[C_j] = ta + p\bar{a}\)</span>. Capital letters denote random binary variables, so that <span class="math inline">\(A_i\)</span> is one if the first rater made an accurate assessment and zero if not. <span class="math inline">\(T\)</span> is the true value of a common subject being rated. The covariance between the two raters’ ratings is</p>
<p><span class="math display">\[
\begin{aligned}
\textrm{Cor}(C_i, C_j) &amp;= \frac{\textrm{Cov}(C_i, C_j)}{\sqrt{\textrm{Var}(C_i)\textrm{Var}(C_j)}} \\
&amp;= \frac{E[(TA_i + \bar{A_i}P_i)(TA_j + \bar{A_j}P_j)] - c^2}{\textrm{Var}(C)} \\
&amp;= \frac{ta^2 + 2ta\bar{a}p + \bar{a}^2p^2  - (ta + p\bar{a})^2}{(ta + p\bar{a})\overline{(ta + p\bar{a})  }} &amp; (\textrm{since }T^2 = T)\\
&amp;= \frac{ta^2 + 2ta\bar{a}p - t^2a^2 - 2tap\bar{a}}{(ta + p\bar{a})\overline{(ta + p\bar{a})  }} \\
&amp;= \frac{a^2t\bar{t}}{c\bar{c }} \\
\end{aligned}
\]</span></p>
<p>Rater accuracy can be obtained via</p>
<p><span id="eq-cor-c"><span class="math display">\[
a^2 =\frac{c\overline{c }}{t\bar{t}} \text{Cor}(C_a, C_b) = \frac{c\overline{c }}{t\bar{t}}\kappa_{fleiss}
\tag{1}\]</span></span></p>
<p>The correlation between two raters’ ratings of the same subject is the intraclass correlation coefficient (ICC) for a two-way random effects model <span class="citation" data-cites="shrout1979intraclass">Shrout &amp; Fleiss (<a href="#ref-shrout1979intraclass" role="doc-biblioref">1979</a>)</span>, which has been shown to be equivalent to the Fleiss kappa as described in <span class="citation" data-cites="fleiss2013statistical">Fleiss et al. (<a href="#ref-fleiss2013statistical" role="doc-biblioref">2013</a>)</span>, p.&nbsp;611-12. Under the <span class="math inline">\(t = p\)</span> unbiased rater assumption, <span class="math inline">\(c = ta + \bar{a}p = p\)</span>, so that the Fliess kappa is (again) shown to be <span class="math inline">\(a^2\)</span> under that condition. The relation <a href="#eq-cor-c" class="quarto-xref">Equation&nbsp;1</a> suggests that the Fliess kappa could be adjusted for cases when <span class="math inline">\(t \ne p\)</span> by making assumptions about those two parameters. For example, maybe the true rate is known from other information. The overall rate of Class 1 ratings <span class="math inline">\(c\)</span> can be estimated directly from the data, but estimating <span class="math inline">\(t\)</span> requires either prior knowledge of the context or using the full t-a-p estimation process, in which case there’s no need to compute the Fliess kappa.</p>
</section>
<section id="correlation-between-ratings-and-true-values" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Correlation Between Ratings and True Values</h1>
<p>It is of interest to find the correlation between <span class="math inline">\(T_i\)</span> the truth value of subject <span class="math inline">\(i\)</span> and the resulting classification <span class="math inline">\(C_i\)</span>. Note that both of the random variables <span class="math inline">\(T_i\)</span> and <span class="math inline">\(C_i\)</span> take only values of zero or one, so squaring them doesn’t change their values. This fact simplifies computations, for example <span class="math inline">\(E[C_i^2] = E[C_i] = ta + p\bar{a}\)</span>. The variance of <span class="math inline">\(C\)</span> is therefore <span class="math display">\[
\begin{aligned}
\textrm{Var}(C) &amp;= E[C^2] - E^2[C] \\
       &amp;= c - c^2 \\
       &amp;= c\bar{c} \\
       &amp;= (ta + p\bar{a})\overline{(ta + p\bar{a})}. \\
\end{aligned}
\]</span> Similarly, <span class="math inline">\(Var(T) = t\bar{t}\)</span>. The correlation between true values and ratings is then</p>
<p><span id="eq-cor-tc"><span class="math display">\[
\begin{aligned}
\text{Cor}(T, C) &amp;= \frac{\text{Cov}(T, C)}{\sqrt{\text{Var}(T)\text{Var}(C)}} \\
&amp;= \frac{E[T(Ta + p\bar{a}) ] - t(ta + p\bar{a})}{\sqrt{t\bar{t} c\bar{c}}  } \\
&amp;= \frac{t(a + p\bar{a})  - t(ta + p\bar{a})}{\sqrt{t\bar{t} c\bar{c}}  } \\
&amp;= a\frac{\sqrt{t\bar{t}}}{\sqrt{c\bar{c}}} \\
&amp;= a\frac{\sigma_T}{\sigma_C}.
\end{aligned}
\tag{2}\]</span></span></p>
<p>Where <span class="math inline">\(\sigma\)</span> is the standard deviation (square root of variance). The relationship in <a href="#eq-cor-tc" class="quarto-xref">Equation&nbsp;2</a> can also be seen as <span class="math inline">\(a = \text{Cor}(T, C) \frac{\sigma_C}{\sigma_T}\)</span>, which means <span class="math inline">\(a\)</span> can be interpreted as the slope of the regression line <span class="math inline">\(C = \beta_0 + \beta_1T + \varepsilon\)</span>, i.e.&nbsp;<span class="math inline">\(a = \beta_1\)</span>. In the unbiased rater case <span class="math inline">\(p = t\)</span>, <span class="math inline">\(\sigma_C = \sigma_T\)</span> and so <span class="math inline">\(\text{Cor}(T, C) = a\)</span>. It can also be shown that for a <span class="math inline">\(t\)</span>-<span class="math inline">\(a_1,a_0\)</span>-<span class="math inline">\(p\)</span> model, the <span class="math inline">\(t=p\)</span> assumption leads to <span class="math inline">\(a = \sqrt{a_1a_0}.\)</span> See <span class="citation" data-cites="eubankscause">Eubanks (<a href="#ref-eubankscause" role="doc-biblioref">2014</a>)</span>.</p>
<p>The two correlations derived here are related by <span class="math inline">\(\text{Cor}^2(T, C) = \text{Cor}(C_i, C_j)\)</span>.</p>
</section>
<section id="alternate-derivation-of-fleiss-kappa-relationship" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Alternate Derivation of Fleiss Kappa Relationship</h1>
<p>This appendix gives an alternative derivation for the Fleiss kappa’s relationship to rater accuracy under the unbiased rater assumption.</p>
<p>The Fleiss kappa <span class="citation" data-cites="fleiss1971measuring">Fleiss (<a href="#ref-fleiss1971measuring" role="doc-biblioref">1971</a>)</span> is a particular case of Krippendorf’s alpha <span class="citation" data-cites="krippendorff1978reliability">Krippendorff &amp; Fleiss (<a href="#ref-krippendorff1978reliability" role="doc-biblioref">1978</a>)</span> and a multi-rater extension of Scott’s pi <span class="citation" data-cites="scott1955reliability">Scott (<a href="#ref-scott1955reliability" role="doc-biblioref">1955</a>)</span>. The statistic compares the overall distribution of ratings (ignoring subjects) to the average over within-subject distributions. These distributions are used to compute the number of observed matches (i.e.&nbsp;agreements) <span class="math inline">\(m_o\)</span> over subjects <span class="math inline">\(i = 1 \dots N\)</span>. For a two-category classification with a fixed number of raters <span class="math inline">\(R&gt;1\)</span> per subject the number of matched ratings for a given subject <span class="math inline">\(i\)</span> is</p>
<p><span class="math display">\[
\begin{aligned}
m_o &amp;= \frac{ {\binom{k_i}{2}} + {\binom{R - k_i}{2}}}{\binom{R}{2}} \\
&amp;= \frac{k_i(k_i-1)+ (R-k_i)(R - k_i-1)}{R(R-1)} \\
&amp;= \frac{2k_i^2 - 2k_iR + R^2-R}{R(R-1)}
\end{aligned}
\]</span></p>
<p>where <span class="math inline">\(k_i\)</span> is the count of Class 1 ratings for the <span class="math inline">\(i\)</span>th subject. The match rates are averaged over the subjects to get <span class="math inline">\(\text{E}[m_o]\)</span> and then a chance correction is applied with</p>
<p><span class="math display">\[
\kappa = \frac{\text{E}[m_i] - \text{E}[m_c]}{1-\text{E}[m_c]},
\]</span></p>
<p>where <span class="math inline">\(\text{E}[m_c]\)</span> is the expected number of matches due to chance. Recall that different agreement statistics make different assumptions about this chance. Using the t-a-p model, and assuming <span class="math inline">\(t = p\)</span>, the true rate of Class 1 <span class="math inline">\(t\)</span> is assumed to be <span class="math inline">\(\text{E}[c_{ij}]\)</span>, so <span class="math inline">\(\text{E}[m_c] = t^2 + (1-t)^2\)</span>, the asymptotic expected match rate for independent Bernoulli trials with success probability <span class="math inline">\(t\)</span>.</p>
<p>By replacing <span class="math inline">\(p\)</span> with <span class="math inline">\(t\)</span> in the t-a-p model’s mixture distribution for the number <span class="math inline">\(k\)</span> of Class 1 ratings a subject is assigned we obtain</p>
<p><span class="math display">\[ Pr(k) = t \binom{R}{k} (a + \bar{a}t)^k (\bar{a}\bar{t})^{R - k} + \bar{t} \binom{R}{k} (\bar{a}t)^k (1 - \bar{a}t)^{R - k} \]</span> so it suffices for large <span class="math inline">\(N\)</span> to write the expected match rate as</p>
<p><span class="math display">\[
\begin{aligned}
      \text{E}[m(a)] &amp;= \sum_{k=0}^R \frac{2k^2 - 2kR + R^2-R}{R(R-1)}\text{Pr}(k;a,t) \\
      &amp;= \sum_{k=0}^R \frac{2k^2 - 2kR + R^2-R}{R(R-1)} \left[ t\binom{R}{k}(a + \bar{a}t)^{k}(\bar{a}\bar{t})^{R-k_i} + \bar{t}\binom{R}{k}(\bar{a}t)^{k}(1-\bar{a}t)^{R-k} \right] \\
      &amp;= \frac{2}{R(R-1)} \sum_{k=0}^R k^2 \left[ t \text{ Binom}(R,k,a+\bar{a}t) + \bar{t} \text{ Binom}(R,k,\bar{a}t) \right] \\
      &amp;- \frac{2R}{R(R-1)} \sum_{k=0}^R k \left[ t \text{ Binom}(R,k,a+\bar{a}t) + \bar{t} \text{ Binom}(R,k,\bar{a}t) \right] \\
      &amp;+ \frac{R(R-1)}{R(R-1)} \sum_{k=0}^R \left[ t \text{ Binom}(R,k,a+\bar{a}t) + \bar{t} \text{ Binom}(R,k,\bar{a}t) \right] \\
      &amp;= \frac{2}{R(R-1)} \left[ tR(a+\bar{a}t)\bar{a}\bar{t}+tR^2(a+\bar{a}t)^2 + \bar{t}R(\bar{a}t)(1-\bar{a}t)+\bar{t}R^2(\bar{a}t)^2\right] \\
      &amp;- \frac{2}{R-1} \left[ tR(a+\bar{a}t) +  \bar{t}R(\bar{a}t)\right] +1 \\
      &amp;= 2a^2(t-t^2) + 2t^2 -2t + 1,
\end{aligned}
\]</span></p>
<p>using the moment identities to gather the sums. Here, <span class="math inline">\(t\)</span> and <span class="math inline">\(R\)</span> are fixed, and <span class="math inline">\(m(a)\)</span> is the average match rate over cases, which depends on unknown <span class="math inline">\(a\)</span> and fixed <span class="math inline">\(t = \text{E}[c_{ij}]\)</span>. Now we can compute the Fleiss kappa with</p>
<p><span class="math display">\[
\begin{aligned}
\kappa_{fleiss} &amp;= \frac{\text{E}[m_i] - \text{E}[m_*]}{1-\text{E}[m_*]} \\
            &amp;= \frac{2a^2(t-t^2) + 2t^2 -2t + 1 - (t^2+(1-t)^2)}{1-(t^2+(1-t)^2)} \\
            &amp;= a^2.
\end{aligned}
\]</span></p>
<p>So kappa is the square of accuracy under the unbiased rater assumption, with constant rater accuracy and fixed number of raters. The relationship does not depend on the true distribution <span class="math inline">\(t\)</span> of Class 1 cases.</p>



</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-eubankscause" class="csl-entry" role="listitem">
Eubanks, D. A. (2014). Causal interfaces. <em>Arxiv.org Preprint</em>. <a href="http://arxiv.org/abs/1404.4884v1">http://arxiv.org/abs/1404.4884v1</a>
</div>
<div id="ref-fleiss1971measuring" class="csl-entry" role="listitem">
Fleiss, J. L. (1971). Measuring nominal scale agreement among many raters. <em>Psychological Bulletin</em>, <em>76</em>(5), 378.
</div>
<div id="ref-fleiss2013statistical" class="csl-entry" role="listitem">
Fleiss, J. L., Levin, B., &amp; Paik, M. C. (2013). <em>Statistical methods for rates and proportions</em>. john wiley &amp; sons.
</div>
<div id="ref-krippendorff1978reliability" class="csl-entry" role="listitem">
Krippendorff, K., &amp; Fleiss, J. L. (1978). Reliability of binary attribute data. <em>Biometrics</em>, <em>34</em>(1), 142–144.
</div>
<div id="ref-scott1955reliability" class="csl-entry" role="listitem">
Scott, W. A. (1955). Reliability of content analysis: The case of nominal scale coding. <em>Public Opinion Quarterly</em>, 321–325.
</div>
<div id="ref-shrout1979intraclass" class="csl-entry" role="listitem">
Shrout, P. E., &amp; Fleiss, J. L. (1979). Intraclass correlations: Uses in assessing rater reliability. <em>Psychological Bulletin</em>, <em>86</em>(2), 420.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>